 # 1. EVENTO DE EJECUCI√ìN: ¬øCu√°ndo debe correr este flujo?
on:
  push:
    branches: [ main ] # Se ejecuta autom√°ticamente cuando se sube c√≥digo a la rama 'main'

# 2. DEFINICI√ìN DE TRABAJOS (JOBS)
jobs:
  build_test_deploy:
    # Este trabajo corre en un entorno de Ubuntu reciente
    runs-on: ubuntu-latest
    
    steps:
    
    # --- PASO 1: CONFIGURACI√ìN E INTEGRACI√ìN CONTINUA (CI) ---
    - name: üì• Clonar el C√≥digo
      uses: actions/checkout@v4
      # Baja el c√≥digo del repositorio al servidor de GitHub Actions
      
    - name: üêç Configurar Entorno Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        
    - name: üö¶ Quality Gate (Pruebas Unitarias)
      # Ejecuta el script de la calculadora, el cual contiene la funci√≥n test_suite()
      run: python calculadora.py
      # **CRUCIAL:** Si 'calculadora.py' termina con un error (c√≥digo 1), este paso FALLA 
      # y el pipeline se detiene autom√°ticamente.

    # --- PASO 2: DESPLIEGUE CONTINUO (CD) ---
    - name: üöÄ Simulaci√≥n de Despliegue (CD)
      # Esta condici√≥n asegura que el paso SOLO corra si los pasos anteriores fueron exitosos.
      if: success()
      run: |
        echo "=========================================================="
        echo "‚úÖ C√≥digo certificado por el Quality Gate."
        echo "Iniciando Despliegue Continuo..."
        echo "Desplegando la versi√≥n V1.0 a un servidor simulado."
        echo "üéâ Despliegue COMPLETADO. El c√≥digo est√° en producci√≥n."
        echo "=========================================================="

